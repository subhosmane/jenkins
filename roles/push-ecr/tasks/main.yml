- include_tasks: pip.yml

- name: build image from cloned repo
  docker_image:
    name: jenkins
    build:
        pull: true
        path: ./docker/
    source: build

- name: Log into ECR if required.
  shell: "$(aws ecr get-login --no-include-email --region {{ ecr_region }})"

- name: Create ecr_repo if not exists
  ecs_ecr:
    name: "{{ namespace }}"
    state: present
    #policy: "{{ lookup('template', 'ecr_policy.json.j2') }}"